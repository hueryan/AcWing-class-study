### 配置环境

```sh
scp /var/lib/acwing/docker/images/django_lesson_1_0.tar ali_server:  # 将 Django 镜像传到服务器
ssh ali_server  # 进入服务器
docker load -i django_lesson_1_0.tar  # 加载镜像
docker images  # 查看镜像
docker run -p 20000:22 -p 8000:8000 --name django_server -itd django_lesson:1.0  # 20000映射到22 登录使用    8000映射8000调试
docker attach django_server  # 进入镜像
adduser hujing  # 增加hujing用户
usermod -aG sudo hujing  # 给hujing用户增加sudo权限
[Ctrl+p] [Ctrl+q]  # 挂起镜像
```

**在终端[切换]**

```sh
vim ~/.ssh/config
<---
Host django_server
  HostName ip
  User hujing
  Port 20000
--->
ssh-copy-id django_server
scp ~/.bashrc ~/.vimrc ~/.tmux.conf django_server:  # 将配置信息传过去
ssh django_server
```

**容器内**

```sh
django-admin --version  # 查看 django 版本
django-admin startproject app  # 创建app
cd app
```

**配置git**

```sh
git init  # 配置 git
ssh-keygen  # 生成密钥对
# 去github等仓库创建
cat ~/.ssh/id_rsa.pub  # 粘贴到网站的ssh
# 配置全局用户名，邮箱
git config --global user.name "hueryan"
git config --global user.email "xxx@xx.com"

git add .
git commit -m "start project"
vim README.md
<---
django project start
--->
git add README.md
git commit -m "add readme"

git remote add acwing git@git.acwing.com:hueryan/django-first.git
git remote add gitee git@gitee.com:hueryan/django-first.git
git remote add github git@github.com:hueryan/django-first.git

git push --set-upstream github master
git push gitee
git push acwing
```

此时项目结构 `tree -a`

```sh
.
|-- README.md
|-- app
|   |-- __init__.py
|   |-- asgi.py
|   |-- settings.py
|   |-- urls.py
|   `-- wsgi.py
`-- manage.py
```

[bilibili配置Pycharm远程登录](https://www.bilibili.com/video/BV1SsbezNE9S)  

```
打开Pycharm
File -> Project: xxx -> Python Interpreter -> Add Interpreter -> On SSH
	输入Host Prot Username 到第三步 选择 System Interpreter 选择远程已有环境
	Sync folders 映射文件夹并且自动更新
Tools -> Deployment -> Configuration -> Connetction 0< SFTP 登录 -> Mappings 映射地址
Tools -> Deployment -> Configuration -> download from 即可同步
```



### 项目

```sh
cd ~/app
python3 manage.py runserver 0.0.0.0:8000  # 在8000端口运行
ip:8000  # 在win浏览器输入公网ip:8000 此时报错，因为django增加机制
ag ALLOWED_HOSTS  # 全局搜索配置 hosts，将公网ip添加进去
# 去文件增加 ip

------优化ip
vim settings.env
<---
DJANGO_HOST = "xxx.xxx.xxx.xxx"
--->
vim settings.py
<---开头引入，并在ALLOWED_HOST 增加 DJANGO_HOST
from dotenv import dotenv_values
import os
# 获取当前脚本所在目录（即 configs 目录）
current_dir = os.path.dirname(os.path.abspath(__file__))
env_path = os.path.join(current_dir, "settings.env")
DJANGO_HOST = dotenv_values(env_path)["DJANGO_HOST"]
--->
```

### 新增项目

```sh
cd ~/app
python3 manage.py startapp game  # 创建game文件夹
touch urls.py
mkdir templates
tree .
.
|-- game
|   |-- __init__.py
|   |-- admin.py  # 存储管理员界面，看到的数据库
|   |-- apps.py
|   |-- migrations
|   |   `-- __init__.py
|   |-- models.py  # 定义各种网站数据库表,各种Class、数据格式
|   |-- templates  # html。mkdir 文件夹 
|   |-- tests.py
|   |-- urls.py  # 路由。自己 touch 的
|   `-- views.py  # 写试图，函数逻辑
`-- manage.py
```

```python
python3 manage.py migrate  # 同步数据库
python3 manage.py runserver 0.0.0.0:8000
python3 manage.py createsuperuser  # 创建管理员用户
```

**提交变化**

[提交变化github](https://github.com/hueryan/django-first/commit/f314d2582d09f161070b6ae37ce8b2d4896dc96a) [提交后文件gitee](https://gitee.com/hueryan/django-first/tree/f314d2582d09f161070b6ae37ce8b2d4896dc96a/) 

